#####################  第一版本  #####################
FROM openjdk:8
ADD *.jar /app/app.jar
ADD entrypoint.sh /app/
ENV TIME Asia/Shanghai
ENV JAVA_OPS -Xmx512m -Xms512m -XX:+UseConcMarkSweepGC
RUN set -e \
    && chmod +x /app/entrypoint.sh \
    && ln -snf /usr/share/zoneinfo/$TIME /etc/localtime \
    && echo $TIME > /etc/timezone
ENTRYPOINT  ["/app/entrypoint.sh"]
EXPOSE 8080
STOPSIGNAL SIGTERM


#!/bin/sh
# exec后面的命令都在同一进程中执行，app.jar服务也跟entrypoint.sh为同一个pid#
# 则执行docker stop containerId时，服务和容器马上停止，若服务是容器的子pid，则容器10s后才停止

# 自定义环境变量启动 docker run --name=docker1 -e JAVA_OPS='-Xmx256m -Xms256m -XX:+UseConcMarkSweepGC -XX:+PrintGCDetails' codingsoldier/docker1
exec java ${JAVA_OPS} -jar /app/app.jar


